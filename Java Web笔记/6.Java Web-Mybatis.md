# 一、MyBatis
## 1）MyBatis入门
### （1）快速入门
步骤：使用MyBatis查询所有用户数据
1. 准备工作（创建springboot工程、数据库表user、实体类User）
- 创建模块，选择Spring Boot生成器，**类型选择Maven**，下一步。
- 然后选择springboot版本为3.4.7，在SQL中选择Mybatis framework，然后选择mysql driver。
- 创建一个User实体类。
2. 引入Mybatis的相关依赖，配置Mybatis（数据库连接信息）
```yml
#配置数据库的连接信息 - 四要素  
#驱动类名称  
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver  
#数据库连接的url  
spring.datasource.url = jdbc:mysql://localhost:3306/mybatis  
#连接数据库的用户名  
spring.datasource.username=root  
#连接数据库的密码  
spring.datasource.password=1234
```
接下来，配置代码如下：
MybatisApplicationTests测试类:  
```java
package com.itheima.mybatis;  
  
import com.itheima.mybatis.mapper.UserMapper;  
import com.itheima.mybatis.pojo.User;  
import org.junit.jupiter.api.Test;  
import org.springframework.beans.factory.annotation.Autowired;  
import org.springframework.boot.test.context.SpringBootTest;  
  
import java.util.List;  
  
@SpringBootTest  //springboot整合单元测试的注释  
class MybatisApplicationTests {  
    @Autowired  
    private UserMapper UserMapper;  
  
    @Test  
    void contextLoads() {  
        List<User> userList = UserMapper.list();  
        userList.stream().forEach(User -> {  
            System.out.println(User);  
        });  
    }  
}
```
User类:
```java
package com.itheima.mybatis.pojo;  
  
public class User {  
    private int id;  
    private String name;  
    private int age;  
    private String gender;  
    private String phone_number;  
  
    public User() {}  
  
    public User(String name, int age, String gender, String phone_number, int id) {  
        this.name = name;  
        this.age = age;  
        this.gender = gender;  
        this.phone_number = phone_number;  
        this.id = id;  
    }  
  
    public int getId() {  
        return id;  
    }  
  
    public void setId(int id) {  
        this.id = id;  
    }  
  
    public String getName() {  
        return name;  
    }  
  
    public void setName(String name) {  
        this.name = name;  
    }  
  
    public int getAge() {  
        return age;  
    }  
  
    public void setAge(int age) {  
        this.age = age;  
    }  
  
    public String getGender() {  
        return gender;  
    }  
  
    public void setGender(String gender) {  
        this.gender = gender;  
    }  
  
    public String getPhone_number() {  
        return phone_number;  
    }  
  
    public void setPhone_number(String phone_number) {  
        this.phone_number = phone_number;  
    }  
  
    @Override  
    public String toString() {  
        return "User{" +  
                "name='" + name + '\'' +  
                ", age=" + age +  
                ", gender='" + gender + '\'' +  
                ", phone_number='" + phone_number + '\'' +  
                ", id=" + id +  
                '}';  
    }  
}
```
3. 编写SQL语句（注解/XML）
UserMapper接口:
```java
package com.itheima.mybatis.mapper;  
  
import com.itheima.mybatis.pojo.User;  
import org.apache.ibatis.annotations.Mapper;  
import org.apache.ibatis.annotations.Select;  
  
import java.util.List;  
  
@Mapper  //在运行是，会自动生成该接口的类对象，并且将该对象交给IOC容器管理  
public interface UserMapper {  
    //查询全部用户信息  
    @Select("select * from user")  
    public List<User> list();  
}
```
@select后面即操作数据库的sql语句。
### （2）JDBC介绍
jdbc程序：
1. 注册驱动
2. 获取连接
3. 获取执行sql的对象Statement，执行sql
4. 释放资源
### （3）数据库连接池
- 数据库连接池是个容器，负责分配、管理数据库连接
- 它允许应用程序重复使用一个现有的数据库连接，而不是再重新建立一个
- 释放空闲时间超过最大空闲时间的连接，来避免因为没有释放连接而引起的数据库连接遗漏
**优势：**
- 资源重用
- 提升系统相应速度
- 避免数据库连接泄露

**标准接口：DataSource**
- 官方（sun）提供的数据库连接池接口，由第三方组织实现此接口。
- 功能：获取连接
语法：
```java
Connection getConnection() throws SQLException;
```
- 常见产品：
C3P0、DBCP、Druid、Hikari
- 切换Druid数据库连接池
官方地址: [Druid](https://github.com/alibaba/druid/tree/master/druid-spring-boot-starter)
在pom.xml中配置：
```xml
<!--    druid数据库连接池    -->  
<dependency>  
    <groupId>com.alibaba</groupId>  
    <artifactId>druid-spring-boot-starter</artifactId>  
    <version>1.2.8</version>  
</dependency>
```
### （4）lombok
![](./图片/lombok.png)
所以新的实体User就为：
```java
package com.itheima.mybatis.pojo;  
import lombok.*;  
  
  
//@Getter        )  
//@Setter            )   ==   @Data  
//@ToString     )  
//@EqualsAndHashCode  
  
@Data  
@NoArgsConstructor  //无参构造  
@AllArgsConstructor  //全参构造  
public class User {  
    private int id;  
    private String name;  
    private int age;  
    private String gender;  
    private String phoneNumber;
```
# 二、Mybatis基础操作
